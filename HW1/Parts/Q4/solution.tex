% !TeX root = ../../main.tex
\documentclass[../AAE590SC_HW1.tex]{subfiles}
\begin{document}

The risk sensitive control policy is 
\begin{subequations}
    \begin{flalign*}
        \min_{\mu_0 : T-1} & \mathcal{L}_\theta, \: \theta\in\R \\
        \text{where } & \mathcal{L}_\theta = \begin{cases}
        \frac{1}{\theta}\log(\mathbb{E}(\exp(\theta C_{0:T}))) & \text{ if } \theta \neq 0 \\
        \mathbb{E}(C_{0:T}) & \text{ if } \theta = 0
        \end{cases}
    \end{flalign*}
\end{subequations}

Assume $\theta \neq 0$ then $\mathcal{L}_\theta = \frac{1}{\theta}\log(\mathbb{E}(\exp(\theta C_{0:T})))$.
The Maclaurin series in $\theta$ of $\exp(a\theta)$ is 
\begin{gather*}
    \exp(a\theta) = 1 + a\theta + \frac{a^2\theta^2}{2} + \dots
\end{gather*}
The Maclaurin series in $x$ of $\log(1 + x)$ is 
\begin{gather*}
    \log(1 + x) = x - \frac{1}{2}x^2 + \frac{1}{3}x^3 - \dots
\end{gather*}

Substituting the Macluarin series for $\exp(a\theta)$ into $\mathcal{L}_\theta$ gives
\begin{gather*}
    \mathcal{L}_\theta = \frac{1}{\theta}\log(\mathbb{E}(1 + \theta C_{0:T} + \frac{(\theta C_{0:T})^2}{2} + \dots))    
\end{gather*}
Using linearity of expectation,
\begin{gather*}
    \mathcal{L}_\theta = \frac{1}{\theta}\log(1 + (\theta \mathbb{E}C_{0:T} + \frac{\theta^2}{2} \mathbb{E}(C_{0:T})^2 + \dots))
\end{gather*}
Defining $x = (\theta \mathbb{E}C_{0:T} + \frac{\theta^2}{2} \mathbb{E}(C_{0:T})^2 + \dots)$, the Maclaurin seris for $\log(1 + x)$ can be used
\begin{gather*}
    \mathcal{L}_\theta = \frac{1}{\theta}((\theta\mathbb{E}C_{0:T} + \frac{\theta^2}{2}\mathbb{E}(C_{0:T}^2) + \dots) - \frac{1}{2}(\theta(\mathbb{E}C_{0:T})^2 + \text{H.O.T}) + \text{H.O.T}) + \text{H.O.T}
\end{gather*}
Therefore, using the first two leading terms $\mathcal{L}_\theta$ can be approximated by
\begin{gather*}
    \mathcal{L}_\theta \approx \mathbb{E}C_{0:T} + \frac{1}{2}(\mathbb{E}(C_{0:T}^2) - (\mathbb{E}C_{0:T})^2)\theta
\end{gather*}
Noticing that $\text{Var}(C_{0:T}) = \mathbb{E}(C_{0:T}^2) - (\mathbb{E}C_{0:T})^2$
\begin{gather*}
    \mathcal{L}_\theta \approx \mathbb{E}C_{0:T} + \frac{1}{2}\text{Var}(C_{0:T})\theta
\end{gather*}
It is now obvious that 
\begin{gather*}
    \begin{cases}
        \theta > 0 & \text{means that } \text{Var}(C_{0:T}) \text{ is penalized (risk averse)} \\
        \theta < 0 & \text{means that } \text{Var}(C_{0:T}) \text{ is rewarded (risk seeking)}
    \end{cases}
\end{gather*}


In solving this I referenced https://laurentlessard.com/teaching/me7247/lectures/lecture%2023%20-%20risk-averse%20control.pdf

\end{document}